# 소개 
Contrastive Counterfactual Learning for Causality-aware Interpretable Recommender System 논문을 구현하고 공부하기 위한 저장소입니다.

# 일정
| 날짜 | 내용 | 
| -------- | -------- |
| 2025/03/25 | 논문 구현 | 
| 2025/04/01 | 논문 구현 및 분석 | 
| 2025/04/08 | 샘플링 방법 탐구, 추가 데이터로 실험 | 
| 2025/04/15 | 결정된 샘플링 방법 적용 후 성능 평가, 시각화로 결과 입증 | 
| 2025/04/22 | Gradio 대시보드 개발|
| 2025/04/29 | Gradio 대시보드 개발| 
| 2025/05/06 | |
| 2025/05/13 | | 
| 2025/05/20 | |
---

### 진행 현황(2025.04.01)
  ### 사용 데이터
  - **coat 데이터**
      - **Train 데이터**: 유저 290명, 아이템 300개, 6960개의 상호작용 데이터
      - **Test 데이터**: 유저 290명, 아이템 300개, 4640개의 상호작용 데이터
- #### 코드 구현
  논문에서 제안한 방식 구현 (Counterfactual sampling)
  
  **CCL 손실함수(Lambda) 값에 따른 성능 비교**
  | Metric / Lambda | ndcg@5(↑) | ndcg@10(↑) | Gini Index(↓) | Test MSE(↓) |
  | --- | --- | --- | --- | --- |
  | 0.5 | 0.6095 | 0.6847 | 0.3483 | 0.2665 |
  | 0.7 | 0.6417 | 0.7063 | 0.3254 | 0.2689 |
  | 1   | 0.6223 | 0.6958 | 0.3345 | 0.2685 |
  | 1.3 | 0.6077 | 0.6778 | 0.347  | 0.2662 |
  | 1.5 | 0.6102 | 0.6870 | 0.3310 | 0.2665 |

- ##### 문제점
  - 논문에서 제안한 방식의 성능이 간단한 MF 모델보다 낮음.
  - 인기도 기반 샘플링 방법은 아이템 별로 인기도를 계산해 차이가 가장 큰 아이템을 샘플로 사용 → 대부분 동일한 아이템을 추출하는 문제 발생.
 
  
- #### 이를 대체하기 위한 간단한 실험 방법
  아이템마다 인기도 차이를 계산한 값을 샘플링 확률로 사용하여 진행.

  | Metrics        | 기존 CCL | 개선된 CCL |
  | ---            | ---      | ---        |
  | Test MSE       | 0.2722   | 0.2711     |
  | Test AUC       | 0.6858   | 0.6859     |
  | NDCG@5         | 0.545    | 0.5800     |
  | NDCG@10        | 0.6290   | 0.6535     |
  | Gini Index     | 0.3682   | 0.3470     |
  | Global Utility | 0.4648   | 0.4840     |

  ---

### 진행현황(2025.04.08)
  ### 실험 진행 
  - ## MF 기반의 적용 결과와 NCF 기반의 적용 결과 비교
  
    | Metrics        | MF | MF_CF | MF_pop | NCF | NCF_CF | NCF_pop |
    | ---            | ---      | ---      | ---      | ---      | ---      | ---      | 
    | Test MSE       | 0.2649   | 0.2736   | 0.2731   | 0.2576   | 0.2622   | 0.2606   |
    | Test AUC       | 0.7074   | 0.6823   | 0.6817   | 0.7324   | 0.7275   | 0.7338   |
    | NDCG@5         | 0.6045   | 0.5624   | 0.5536   | 0.6158   | 0.5823   | 0.5858   |
    | NDCG@10        | 0.6861   | 0.6394   | 0.6424   | 0.6886   | 0.6670   | 0.6673   |
    | Gini Index     | 0.3234   | 0.3421   | 0.3601   | 0.3680   | 0.3680   | 0.3789   |
    | Global Utility | 0.4924   | 0.4703   | 0.4627   | 0.4012   | 0.4012   | 0.4813   |
  
    - 전체적으로, NCF 모델을 통한 학습의 결과가 좋은 성능을 보임

  - ## Movielens 데이터로의 실험 추가
      Coat 데이터는 랜덤한 상황을 가정한 test셋을 구성하였지만, 랜덤하지 않은 데이터에서의 결과 확인 Movielens-100K 데이터는 유저당 10개의 아이템과 상호작용한 test셋으로 구성되어 있음
    
      | Metrics        | MF      | MF_CF   | MF_pop  | NCF     | NCF_CF  | NCF_pop  |
      |----------------|---------|---------|---------|---------|---------|---------|
      | Test MSE       | 0.1651  | 0.1671  | 0.1672  | 0.1568  | 0.1564  | 0.1571  |
      | Test AUC       | 0.7507  | 0.7268  | 0.7291  | 0.7864  | 0.7801  | 0.7830  |
      | NDCG@5         | 0.9338  | 0.9367  | 0.9323  | 0.9536  | 0.9487  | 0.9487  |
      | NDCG@10        | 0.8791  | 0.9367  | 0.9378  | 0.9378  | 0.9351  | 0.9351  |
      | Gini Index     | 0.0761  | 0.0783  | 0.0736  | 0.0765  | 0.0765  | 0.0749  |
      | Global Utility | 0.9066  | 0.9056  | 0.9020  | 0.9090  | 0.9051  | 0.9085  |
---
### 진행현황(2025.04.15)
  ### 실험 결과 시각화
  
  - 유저의 성향에 따른 추천된 아이템의 인기도 비교
    
    - 1. 유저가 상호작용한 아이템의 평균 인기도가 가장 높은 20명의 유저(Top 20 User)
    - 2. 유저가 상호작용한 아이템의 평균 인기도가 가장 낮은 20명의 유저(Low 20 User)
         
  - Coat
    
    <img src = "https://github.com/user-attachments/assets/60a60ff3-81f0-4ab5-be84-5886ca9cf78a" alt="image" width = "600" />
    
    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.4995
    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.2290
  - Movielens
    
    <img src = "https://github.com/user-attachments/assets/ea71cbc3-6e1f-47d5-93a7-805d82f92028" alt="image" width = "600" />
    
    - Train 데이터에서 Top 20 User들이 상호작용한 아이템들의 평균 인기도는 0.7119
    - Train 데이터에서 Low 20 User들이 상호작용한 아이템들의 평균 인기도는 0.3564
---
### 진행현황(2025.04.29)
### Gradio 대시보드 개발
대시보드 사용자와 유사한 취향의 유저를 데이터에서 찾아, 영화를 추천해줌

- 대시보드 사용자가 추천 시스템에 활용할 모델(MF or NCF)과 샘플링 방법(Counterfactual-Based, Popularity-Based)을 선택
  
  <img src = "https://github.com/user-attachments/assets/0c4edeff-89b2-4660-8114-4ef9962a24da" alt="image" width = "600" />

- 사용자가 좋아하는 영화를 반복적으로 선택하여, 취향이 비슷한 유저를 특정
  
  <img src = "https://github.com/user-attachments/assets/adc6a97f-11ed-4ba2-af83-6060064f786e" alt="image" width = "600" />

- 사용자가 좋아하는 영화를 입력받아, 유사한 유저가 train 셋에서 좋아하는 영화들의 인기도 평균을 제공

  <img src = "https://github.com/user-attachments/assets/59520050-17a8-4d2f-b7ee-95cb1c9fe4cf" alt="image" width = "600" />

- 인과추론 방법론이 적용되지 않은 상태의 추천 결과(Standard)와 적용된 상태의 추천 결과(Compare)를 비교하도록, 영화 제목과 인기도를 출력

  <img src = "https://github.com/user-attachments/assets/724680ed-b0ea-4f0c-abca-dac13de63e04" alt="image" width = "600" />

- TMDB의 API를 사용하여, 추천된 영화 제목을 검색해 해당 영화의 포스터 이미지 제공

  <img src = "https://github.com/user-attachments/assets/b058c686-b3ef-4934-a4d0-5ead9f256eac" alt="image" width = "600" />

### 다음 계획
- 논문 소개와 결과를 비교한 시각화 자료를 정리해 Gradio에 반영
  
