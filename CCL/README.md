# 소개 
Contrastive Counterfactual Learning for Causality-aware Interpretable Recommender System 논문을 구현하고 공부하기 위한 저장소입니다.

# 일정
| 날짜 | 내용 | 
| -------- | -------- |
| 2025/03/25 | 논문 구현 | 
| 2025/04/01 | 논문 구현 및 분석 | 
| 2025/04/08 | 샘플링 방법 탐구, 추가 데이터로 실험 | 
| 2025/04/15 | 결정된 샘플링 방법 적용 후 성능 평가, 시각화로 결과 입증 | 
| 2025/04/22 | |
| 2025/04/29 | | 
| 2025/05/06 | |
| 2025/05/13 | | 
| 2025/05/20 | |
---

### 진행 현황(2025.04.01)
  ### 사용 데이터
  - **coat 데이터**
      - **Train 데이터**: 유저 290명, 아이템 300개, 6960개의 상호작용 데이터
      - **Test 데이터**: 유저 290명, 아이템 300개, 4640개의 상호작용 데이터
- #### 코드 구현
  논문에서 제안한 방식 구현 (Counterfactual sampling)
  
  **CCL 손실함수(Lambda) 값에 따른 성능 비교**
  | Metric / Lambda | ndcg@5(↑) | ndcg@10(↑) | Gini Index(↓) | Test MSE(↓) |
  | --- | --- | --- | --- | --- |
  | 0.5 | 0.6095 | 0.6847 | 0.3483 | 0.2665 |
  | 0.7 | 0.6417 | 0.7063 | 0.3254 | 0.2689 |
  | 1   | 0.6223 | 0.6958 | 0.3345 | 0.2685 |
  | 1.3 | 0.6077 | 0.6778 | 0.347  | 0.2662 |
  | 1.5 | 0.6102 | 0.6870 | 0.3310 | 0.2665 |

- ##### 문제점
  1. 논문에서 제안한 방식의 성능이 간단한 MF 모델보다 낮음.
  2. 인기도 기반 샘플링 방법은 아이템 별로 인기도를 계산해 차이가 가장 큰 아이템을 샘플로 사용 → 대부분 동일한 아이템을 추출하는 문제 발생.

- #### 이를 대체하기 위한 간단한 실험 방법
  아이템마다 인기도 차이를 계산한 값을 확률로 사용하여 샘플링 진행.

  | Metrics        | 기존 CCL | 개선된 CCL |
  | ---            | ---      | ---        |
  | Test MSE       | 0.2722   | 0.2711     |
  | Test AUC       | 0.6858   | 0.6859     |
  | NDCG@5         | 0.545    | 0.5800     |
  | NDCG@10        | 0.6290   | 0.6535     |
  | Gini Index     | 0.3682   | 0.3470     |
  | Global Utility | 0.4648   | 0.4840     |
  
---
