# Causal Representation Learning for OOD Recommendation

본 프로젝트는 논문  **"Causal Representation Learning for Out-of-Distribution Recommendation"** 을 바탕으로 인과 표현 학습 기반 추천 시스템을 구현하고, 이를 LLM 기반 추천 에이전트로 확장하는 것을 목표로 합니다.


## 주간 일정 (2025.04.08 ~ 2025.05.20)

| 주차       | 일정                                 | 세부 내용 |
|------------|--------------------------------------|-----------|
| 4/08 (1주차) | 논문 구조 분석 및 1차 구현 | 모델 구성 요소 파악, 구현 범위 설정 |
| 4/15 (2주차) | 데이터셋 구성 + OOD 시나리오 설계      |  |
| 4/22 (3주차) | 모델 구현 완료 (Causal 구조 포함)       |  |
| 4/29 (4주차) | LLM 에이전트 1차 개발         | 추천 시스템 초기 구현 |
| 5/06 (5주차) | LLM 에이전트 및 추천 시스템 고도화      | |
| 5/13 (6주차) | LLM 에이전트 2차 개발 | 시연 스크립트(질의 시나리오) 구성 |
| 5/20 (7주차) | 회고  | 전체 구조 리뷰, 코드 리팩토링, 문서화 및 기능 정리 |


## 진행 상황 (2025.04.08 기준)

### 사용 데이터

| 데이터셋   | 설명 |
|------------|------|
| **Synthetic** | 논문 내 toy 실험 재현용 인위적 데이터셋<br>유저 1,000명, 아이템 1,000개, IID/OOD/X_OOD 세트 포함 |
| **Meituan** | 실제 상업용 추천 데이터셋<br>유저 2,145명, 아이템 7,189개, OOD 분포 구성 포함 |



### 모델 및 실험 설정

- 모델: `COR`, `COR_G`  
- 목적: 인과 표현 학습 기반 Z1 (추천용), Z2 (OOD 적응용) 분리
- 평가 지표: Precision / Recall / NDCG / MRR (Top-N 기준)


### 주요 결과

#### 1. Synthetic (COR 모델)

| Metric     | @10   | @20   | @50   | @100  |
|------------|--------|--------|--------|--------|
| Precision  | 0.2626 | 0.2273 | 0.1642 | 0.1106 |
| Recall     | 0.1832 | 0.3086 | 0.5543 | 0.7506 |
| NDCG       | 0.2899 | 0.3029 | 0.4041 | 0.4807 |
| MRR        | 0.4692 | 0.4745 | 0.4768 | 0.4771 |

- OOD 성능: Recall 및 NDCG 모두 높은 편  
- 논문 성능과 유사한 분포로 재현 성공



#### 2. Meituan

**COR 결과**

| Metric     | @10   | @20   | @50   | @100  |
|------------|--------|--------|--------|--------|
| Precision  | 0.0317 | 0.0268 | 0.0212 | 0.0153 |
| Recall     | 0.1446 | 0.2542 | 0.4718 | 0.6749 |
| NDCG       | 0.1553 | 0.1865 | 0.2856 | 0.3511 |

**COR_G 결과 (GCN 적용)**

| Metric     | @10    | @20    | @50    | @100   |
|------------|---------|---------|---------|---------|
| Precision  | 0.0011  | 0.0009  | 0.0006  | 0.0005  |
| Recall     | 0.0112  | 0.0172  | 0.0294  | 0.0480  |
| NDCG       | 0.0063  | 0.0078  | 0.0102  | 0.0132  |
| MRR        | 0.0047  | 0.0052  | 0.0055  | 0.0058  |



### 문제점 및 해결 방향

- `COR_G` 모델 성능 저하: GCN 구조와 hidden size mismatch로 학습 불안정
- Z1/Z2 병합 시 차원 오류 및 decode layer 차원 오류 발생
- Meituan 데이터에서는 구조에 민감한 경향 → 다양한 구조 튜닝 필요

**해결 방향**
- 구조 재설계 및 MLP 차원 동기화
- 기존 베이스라인(MultiVAE 등)과 동일 환경 비교 예정
- 질의형 추천 및 LLM 연동 실험 준비 중